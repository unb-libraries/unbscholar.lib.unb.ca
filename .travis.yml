language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: VXYnkG9fyhjERRhSj+efdXQBZwR9rbzn9wmdw6m6/dOgX6+ZEQcmAWU4FzpeMpcYd+4Kp58Gwj7afpDjzDJ5uLLXluzKSeHhmi2hAuHOoMhwU7aZcXiNksRqGqT/pxu3wTjUG2Y9zmvNblMzT1WiX6r6SqXGUo4RHpIZQU5YMCur8V8uAfF2Kggfl+niSdUoigabCJad7+5xveZqk/1FbZbjh4m9ki3kpTVuVB4hNamlZUJG/EclDJwbAiBcc8ZMln7NvpUtY0WKRk0dIAuPA6kPjQkXOBhz32oYip3l4lFydPMhQ9/lj9MAuurEq9SrBR5s14YrI34vVGHlFLDAozosCy9C6+aLJ/+iVuBnp1UknsTX1bl/VqRw1naTdUJsplov9sLiNqkK7L7cspIN8LMGrlqJPHXyZ878/wgXE01n7ed+aD3lBtgTexHZDIt6mcOibuKuCe7GyyGFtjDGnK8MIjn3iUSCoY4B6n9/ske+LM7G34mnMj9m4dTpi8A4qQViCc9v4NlgbCq/nllqraOqw7zhz6VPyR9nhPvxy/aA4V1Cv9QyzkI8FLfKjrxf78VhbdhANSoh6a58uAEXPgwHCGpFguJOelIESmcpmxGBVCvrwgRlejivGJPmqlYkKg43IDZSdHwtqdTtgffb/zUIxJ/oQbXw7Itfe2KUpWE=
    on_start: always
    on_success: always
